<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Roleta de Pr√™mios</title>
<style>
  :root{
    --bg1:#0b1020; --bg2:#121a33; --gold:#f6c453; --ring:#1f2a4d; --text:#eef3ff;
    --btn:#2b61ff; --btn-h:#204ad1;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; display:flex; flex-direction:column; align-items:center; justify-content:center;
    gap:18px; min-height:100vh;
    background:url("fundo-roleta.png") center/cover no-repeat fixed;
    color:var(--text); font:500 16px/1.4 system-ui,Segoe UI,Roboto,Ubuntu,Inter,Arial;
    -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
    position:relative; padding:20px 0;
  }
  
  /* Campo de t√≠tulo edit√°vel */
  .title-section{
    display:flex; flex-direction:column; align-items:center; gap:12px; margin-bottom:20px; 
    width:100%; text-align:center; padding:0 20px;
  }
  .title-input{
    background:rgba(0,0,0,0.7); border:3px solid #f6c453; border-radius:15px; 
    padding:15px 25px; color:#fff; font-size:1.4rem; font-weight:700; 
    text-align:center; backdrop-filter:blur(10px); width:min(90vw,600px);
    transition:all 0.2s ease; text-shadow:2px 2px 4px rgba(0,0,0,0.8);
    box-shadow:0 8px 25px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.2);
    margin:0 auto;
  }
  .title-input:focus{outline:none; box-shadow:0 0 0 4px rgba(246,196,83,0.4), 0 8px 25px rgba(0,0,0,0.4);}
  .title-input::placeholder{color:#ccc;}
  
  /* Logo 3D */
  .logo3d{
    width:min(90vw,600px); height:auto; user-select:none; -webkit-user-drag:none;
    animation:floatY 3.2s ease-in-out infinite; filter:drop-shadow(0 14px 24px rgba(0,0,0,.45));
  }
  @keyframes floatY{
    0%,100%{transform:translateY(0)}
    50%{transform:translateY(-10px)}
  }
  
  /* Bot√µes do topo */
  .top-controls{
    position:absolute; top:20px; right:20px; display:flex; gap:12px; z-index:20;
  }
  .icon-btn{
    appearance:none; border:0; background:rgba(0,0,0,0.35); border-radius:50%; 
    width:48px; height:48px; display:flex; align-items:center; justify-content:center;
    cursor:pointer; transition:all 0.2s ease; backdrop-filter:blur(8px);
    border:1px solid rgba(255,255,255,0.15);
  }
  .icon-btn:hover{background:rgba(0,0,0,0.55); transform:scale(1.05)}
  .icon-btn img{width:24px; height:24px;}
  .icon-btn span{font-size:24px; line-height:1;}
  
  .stage{
    position:relative; width:min(90vw,700px); aspect-ratio:1/1; display:grid; place-items:center;
    filter:drop-shadow(0 18px 40px rgba(0,0,0,.45));
  }
  canvas{width:100%; height:100%}
  .rim{
    position:absolute; inset:0; pointer-events:none; border-radius:50%;
    background:
      radial-gradient(closest-side, rgba(255,255,255,.06), transparent 55%),
      conic-gradient(from 0turn, transparent 0 25%, rgba(255,255,255,.05) 0 30%, transparent 0 100%);
    box-shadow:
      inset 0 0 0 10px var(--gold),
      inset 0 0 0 16px rgba(0,0,0,.35),
      0 0 0 2px rgba(255,255,255,.08);
  }
  .pointer{
    position:absolute; top:-12px; left:50%; translate:-50% 0; width:0; height:0;
    border-left:22px solid transparent; border-right:22px solid transparent;
    border-bottom:40px solid var(--gold); filter:drop-shadow(0 6px 12px rgba(0,0,0,.7));
    z-index:10; transform:rotate(180deg);
  }
  .pointer::after{
    content:''; position:absolute; top:38px; left:-8px; width:16px; height:16px;
    background:radial-gradient(circle, #fff 0%, #ffe089 45%, #a67600 100%);
    border-radius:50%; box-shadow:0 0 8px 2px rgba(255,209,89,.8);
  }
  .controls{display:flex; flex-wrap:wrap; gap:12px; align-items:center; justify-content:center; padding:0 12px}
  button{
    appearance:none; border:0; padding:12px 18px; border-radius:12px; font-weight:700;
    background:linear-gradient(180deg, var(--btn), #234fe6); color:white; cursor:pointer;
    box-shadow:0 8px 20px rgba(35,79,230,.35), inset 0 1px 0 rgba(255,255,255,.25);
    letter-spacing:.2px; transition:transform .06s ease, background .2s ease, box-shadow .2s ease;
  }
  
  /* Bot√£o de girar especial - removido fundo */
  #spinBtn{
    background:none !important;
    color:#000 !important;
    font-size:1.2rem !important;
    font-weight:800 !important;
    padding:0 !important;
    border-radius:0 !important;
    box-shadow:none !important;
    border:none !important;
    text-shadow:none !important;
    letter-spacing:0 !important;
  }
  
  #spinBtn:hover{
    transform:none !important;
    box-shadow:none !important;
  }
  
  #spinBtn:active{
    transform:none !important;
  }
  
  #spinBtn:disabled{
    opacity:0.6 !important;
    cursor:not-allowed !important;
    transform:none !important;
  }
  
  /* Garantir que o bot√£o de girar n√£o seja afetado por outras regras */
  #spinBtn.center-spin-btn{
    transform:translate(-50%, -50%) !important;
  }
  
  /* Bot√£o circular no centro da roleta - apenas SVG */
  .center-spin-btn{
    position:absolute !important;
    top:50% !important;
    left:50% !important;
    transform:translate(-50%, -50%) !important;
    z-index:20 !important;
    width:80px !important;
    height:80px !important;
    border:none !important;
    padding:0 !important;
    margin:0 !important;
    display:flex !important;
    align-items:center !important;
    justify-content:center !important;
    background:none !important;
    cursor:pointer !important;
    outline:none !important;
    transition:all 0.3s ease !important;
  }
  
  .center-spin-btn svg{
    transition:transform 0.3s ease !important;
    filter:drop-shadow(0 2px 4px rgba(0,0,0,0.3)) !important;
  }
  
  .center-spin-btn:hover svg{
    transform:rotate(45deg) !important;
    filter:drop-shadow(0 3px 6px rgba(0,0,0,0.4)) !important;
  }
  
  .center-spin-btn:active svg{
    transform:rotate(90deg) !important;
  }
  
  /* Anima√ß√£o quando est√° girando */
  .center-spin-btn.spinning svg{
    animation:spin-icon 1s linear infinite !important;
  }
  
  @keyframes spin-icon{
    0%{transform:rotate(0deg);}
    100%{transform:rotate(360deg);}
  }
  
  .center-spin-btn:hover{
    transform:translate(-50%, -50%) scale(1.1) !important;
  }
  
  .center-spin-btn:active{
    transform:translate(-50%, -50%) scale(1.05) !important;
  }
  
  .center-spin-btn:disabled{
    opacity:0.6 !important;
    cursor:not-allowed !important;
    transform:translate(-50%, -50%) !important;
  }
  button:disabled{opacity:.65; cursor:not-allowed; box-shadow:none}
  button:hover:not(:disabled):not(#spinBtn){transform:translateY(-1px); background:linear-gradient(180deg, var(--btn-h), #1a3fb8)}
  .msg{min-height:1.6em; font-weight:700; text-align:center}
  .hint{opacity:.75; font-size:.9rem}
  
  /* Modal de configura√ß√£o */
  .modal{display:none; position:fixed; z-index:1000; left:0; top:0; width:100%; height:100%; 
    background:rgba(0,0,0,0.8); backdrop-filter:blur(6px);}
  .modal-content{
    background:linear-gradient(135deg, #0e1630, #1a2440); color:#e6eeff; 
    border:3px solid #f6c453; border-radius:25px; padding:30px; margin:3% auto;
    width:min(95vw,700px); box-shadow:0 30px 100px rgba(0,0,0,.8);
    max-height:90vh; overflow-y:auto;
  }
  .modal-header{display:flex; justify-content:space-between; align-items:center; margin-bottom:25px;
    padding-bottom:15px; border-bottom:2px solid #2d4a6b;}
  .modal-header h2{margin:0; color:#f6c453; font-size:1.8rem; text-shadow:0 2px 4px rgba(0,0,0,0.5);}
  .close{color:#aaa; font-size:32px; font-weight:bold; cursor:pointer; background:none; border:none;
    transition:all 0.2s ease; padding:5px; border-radius:50%;}
  .close:hover{color:#fff; background:rgba(255,255,255,0.1);}
  
  /* Modal de informa√ß√µes espec√≠fico */
  #infoModal .modal-content{
    background:#ffffff; color:#333333;
  }
  #infoModal .modal-header{
    border-bottom:2px solid #e0e0e0;
  }
  #infoModal .modal-header h2{
    text-shadow:0 2px 4px rgba(0,0,0,0.2);
  }
  #infoModal .close{
    color:#666;
  }
  #infoModal .close:hover{
    color:#333; background:rgba(0,0,0,0.1);
  }
  
  .settings-grid{display:grid; grid-template-columns:repeat(auto-fit, minmax(300px, 1fr)); gap:25px; margin:20px 0;}
  .settings-card{
    background:rgba(0,0,0,0.3); border:2px solid #2d4a6b; border-radius:15px; padding:20px;
    transition:all 0.3s ease;
  }
  .settings-card:hover{border-color:#f6c453; transform:translateY(-2px);}
  .settings-card h3{color:#f6c453; margin:0 0 15px 0; font-size:1.2rem; display:flex; align-items:center; gap:10px;}
  .settings-card h3::before{content:"üéõÔ∏è"; font-size:1.5rem;}
  
  /* Tooltips e descri√ß√µes */
  .setting-description{
    color:#b8c5d1; font-size:0.9rem; margin-top:8px; line-height:1.4;
    padding:8px; background:rgba(0,0,0,0.2); border-radius:6px; border-left:3px solid #2d4a6b;
  }
  
  .setting-label{
    display:flex; align-items:center; gap:8px; margin-bottom:10px;
  }
  
  .setting-label .info-icon{
    color:#f6c453; cursor:help; font-size:1rem; opacity:0.7;
    transition:opacity 0.2s ease;
  }
  
  .setting-label .info-icon:hover{
    opacity:1;
  }
  
  .form-group{margin-bottom:20px;}
  .form-group label{display:block; margin-bottom:10px; font-weight:600; color:#e6eeff; font-size:1.1rem;}
  .form-group input, .form-group select{
    width:100%; padding:15px; background:#0a1127; color:#e6eeff; border:2px solid #2d4a6b;
    border-radius:10px; font-size:1rem; transition:all 0.2s ease;
  }
  .form-group input:focus, .form-group select:focus{
    outline:none; border-color:#f6c453; box-shadow:0 0 0 3px rgba(246,196,83,.2);
    background:#0d1a3a;
  }
  
  .switch-container{display:flex; align-items:center; gap:15px; padding:10px; background:rgba(0,0,0,0.2);
    border-radius:10px; border:1px solid #2d4a6b;}
  .switch{position:relative; width:60px; height:30px; background:#2d4a6b; border-radius:15px;
    cursor:pointer; transition:all 0.3s ease;}
  .switch.active{background:#f6c453;}
  .switch::after{content:''; position:absolute; top:3px; left:3px; width:24px; height:24px;
    background:#fff; border-radius:50%; transition:all 0.3s ease;}
  .switch.active::after{transform:translateX(30px);}
  .prizes-section{max-height:400px; overflow-y:auto; padding:10px; background:rgba(0,0,0,0.1); border-radius:10px;}
  .prize-input{display:flex; gap:12px; margin-bottom:15px; align-items:center; padding:10px; 
    background:rgba(255,255,255,0.05); border-radius:8px; border:1px solid rgba(255,255,255,0.1);}
  .prize-number{background:#f6c453; color:#000; border-radius:50%; width:24px; height:24px; 
    display:flex; align-items:center; justify-content:center; font-weight:bold; font-size:0.9rem; 
    flex-shrink:0;}
  .prize-input input[type="text"]{flex:1; background:#0a1127; color:#e6eeff; border:2px solid #2d4a6b; 
    border-radius:8px; padding:12px; font-size:1rem; transition:all 0.2s ease;}
  .prize-input input[type="text"]:focus{outline:none; border-color:#f6c453; box-shadow:0 0 0 3px rgba(246,196,83,.2);}
  .loss-checkbox{display:flex; align-items:center; gap:6px; color:#e6eeff; font-size:0.9rem; 
    flex-shrink:0; cursor:pointer;}
  .loss-checkbox input[type="checkbox"]{width:16px; height:16px; cursor:pointer;}
  .loss-checkbox span{user-select:none;}
  .remove-prize{background:#ef4444; color:#fff; border:0; border-radius:8px; 
    width:36px; height:36px; cursor:pointer; font-weight:bold; transition:all 0.2s ease;
    display:flex; align-items:center; justify-content:center; font-size:18px; line-height:1;}
  .remove-prize:hover{background:#dc2626; transform:scale(1.05);}
  .add-prize{background:linear-gradient(135deg, #22c55e, #16a34a); color:#fff; border:0; border-radius:10px; 
    padding:12px 20px; cursor:pointer; font-weight:600; font-size:1rem; transition:all 0.2s ease;
    box-shadow:0 4px 15px rgba(34,197,94,.3); margin-top:15px;}
  .add-prize:hover{transform:translateY(-2px); box-shadow:0 6px 20px rgba(34,197,94,.4);}
  
  /* Campo de t√≠tulo no modal */
  #editEventTitle{width:100%; background:#0a1127; color:#e6eeff; border:2px solid #2d4a6b; 
    border-radius:10px; padding:15px; font-size:1.1rem; transition:all 0.2s ease;}
  #editEventTitle:focus{outline:none; border-color:#f6c453; box-shadow:0 0 0 3px rgba(246,196,83,.2);}
  .modal-buttons{display:flex; gap:12px; justify-content:flex-end; margin-top:20px;}
  .btn-save{background:linear-gradient(135deg, var(--btn), #234fe6); color:#fff; 
    border:0; padding:12px 24px; border-radius:8px; cursor:pointer; font-weight:700;}
  .btn-cancel{background:#6b7280; color:#fff; border:0; padding:12px 24px; 
    border-radius:8px; cursor:pointer; font-weight:700;}

  /* Popup de Pr√™mio */
  .prize-popup{
    position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8);
    display:flex; align-items:center; justify-content:center; z-index:2000;
    animation:fadeIn 0.3s ease-out;
  }
  .prize-content{
    background:linear-gradient(135deg, #0e1630, #1a2440); border:3px solid #f6c453;
    border-radius:25px; padding:50px; text-align:center; max-width:500px; margin:20px;
    box-shadow:0 25px 80px rgba(0,0,0,.8), 0 0 0 1px rgba(246,196,83,0.3);
    animation:popupIn 0.5s ease-out;
  }
  .prize-content h2{
    color:#f6c453; font-size:2.5rem; margin:0 0 25px 0; text-shadow:0 2px 4px rgba(0,0,0,0.5);
  }
  .prize-content p{
    color:#e6eeff; font-size:1.6rem; margin:0 0 35px 0; font-weight:600;
  }
  .prize-close{
    background:linear-gradient(135deg, var(--btn), #234fe6); color:#fff; border:0;
    padding:15px 40px; border-radius:30px; cursor:pointer; font-weight:700; font-size:1.3rem;
    transition:all 0.2s ease; box-shadow:0 4px 15px rgba(35,79,230,.3);
  }
  .prize-close:hover{transform:translateY(-2px); box-shadow:0 6px 20px rgba(35,79,230,.4);}
  
  @keyframes fadeIn{
    from{opacity:0;} to{opacity:1;}
  }
  @keyframes popupIn{
    from{transform:scale(0.5); opacity:0;} to{transform:scale(1); opacity:1;}
  }
  
  @keyframes rotate360{
    from{transform:rotate(0deg);} to{transform:rotate(360deg);}
  }

  /* Rodap√© */
  .percentage-total{
    margin-top:15px; padding:10px; background:rgba(0,0,0,0.2); 
    border-radius:8px; text-align:center; font-weight:700;
    color:#f6c453; border:1px solid #2d4a6b;
  }
  
  .percentage-item{
    display:flex; align-items:center; margin-bottom:8px; gap:10px;
  }
  
  .percentage-label{
    flex:1; font-size:0.9rem; color:#e6eeff;
  }
  
  .percentage-input{
    width:60px; padding:5px; background:#0a1127; color:#e6eeff;
    border:1px solid #2d4a6b; border-radius:5px; text-align:center;
  }
  
  .percentage-input:focus{
    border-color:#f6c453; outline:none;
  }
  
  .percentage-info{
    margin-top:10px; padding:10px; background:rgba(0,0,0,0.1);
    border-radius:5px; font-size:0.85rem; color:#b8c5d1;
    border-left:3px solid #2d4a6b;
  }

  /* Rodap√© */
  .footer{
    position:fixed; bottom:0; left:0; right:0; 
    background:url("rodape.png") center center no-repeat;
    background-size:contain;
    z-index:100; min-height:60px; max-height:80px;
    display:flex;
    align-items:center;
    justify-content:center;
  }
</style>
</head>
<body>
  <!-- Bot√µes do topo -->
  <div class="top-controls">
    <button class="icon-btn" id="infoBtn" title="Informa√ß√µes">
      <span style="font-size: 24px;">‚ÑπÔ∏è</span>
    </button>
    <button class="icon-btn" id="customizeBtn" title="Editar Pr√™mios">
      <img src="botao-personalizar.png" alt="Editar Pr√™mios" />
    </button>
    <button class="icon-btn" id="settingsBtn" title="Configura√ß√µes">
      <img src="engrenagem.png" alt="Configura√ß√µes" />
    </button>
  </div>

  <!-- Campo de t√≠tulo edit√°vel -->
  <div class="title-section">
    <input type="text" id="eventTitle" class="title-input" placeholder="Digite o t√≠tulo do evento..." value="Show de Pr√™mios">
  </div>

  <!-- Logo 3D -->
  <img class="logo3d" src="titulo-3d-show-de-premios.png" alt="Show de Pr√™mios" />

  <!-- Roleta -->
  <div class="stage" aria-label="Roleta de pr√™mios">
    <div class="pointer" aria-hidden="true"></div>
    <canvas id="wheel" width="1000" height="1000" aria-hidden="true"></canvas>
    <div class="rim" aria-hidden="true"></div>
    <button id="spinBtn" class="center-spin-btn" type="button">
      <svg width="70" height="70" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M1 4v6h6" stroke="white" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M23 20v-6h-6" stroke="white" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15" stroke="white" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </button>
  </div>

  <!-- Controles -->
  <div class="controls">
    <button id="shuffleBtn" type="button">üîÄ Embaralhar</button>
  </div>

  <!-- Resultado -->
  <div class="msg" id="result" role="status" aria-live="polite"></div>
  <div class="hint">üí° Dica: Clique no bot√£o de edi√ß√£o (‚úèÔ∏è) no canto superior direito para personalizar os pr√™mios da roleta.</div>

  <!-- Modal de Edi√ß√£o de Pr√™mios -->
  <div id="editModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>üéÅ Editar Pr√™mios</h2>
        <button class="close" onclick="closeEditModal()">&times;</button>
      </div>
      
      <div class="form-group">
        <label>üìù T√≠tulo do Evento:</label>
        <input type="text" id="editEventTitle" class="title-input" placeholder="Digite o t√≠tulo do evento...">
        <div class="setting-description">
          Personalize o nome que aparece no topo da roleta.
        </div>
      </div>
      
      <div class="form-group">
        <label>üéØ Pr√™mios da Roleta:</label>
        <div class="setting-description">
          Adicione, edite ou remova os pr√™mios que aparecer√£o na roleta. Marque "Perda" para pr√™mios que n√£o s√£o positivos.
        </div>
        <div class="prizes-section" id="prizesContainer">
          <!-- Os inputs dos pr√™mios ser√£o inseridos aqui -->
        </div>
        <button class="add-prize" onclick="addPrize()">‚ûï Adicionar Pr√™mio</button>
      </div>
      
      <div class="modal-buttons">
        <button class="btn-cancel" onclick="closeEditModal()">‚ùå Cancelar</button>
        <button class="btn-save" onclick="savePrizes()">üíæ Salvar Pr√™mios</button>
      </div>
    </div>
  </div>

  <!-- Modal de Configura√ß√µes -->
  <div id="settingsModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Configura√ß√µes Avan√ßadas</h2>
        <button class="close" onclick="closeSettingsModal()">&times;</button>
      </div>
      
      <div class="settings-grid">
        <div class="settings-card">
          <h3>üîä √Åudio</h3>
          <div class="switch-container">
            <span class="footer-text">Som da Roleta</span>
            <div class="switch" id="soundSwitch" onclick="toggleSound()"></div>
          </div>
          <div class="setting-description">
            Ativa ou desativa os sons da roleta (ticks durante o giro e fanfarra ao parar).
          </div>
        </div>
        
        <div class="settings-card">
          <h3>‚ö° Velocidade</h3>
          <div class="form-group">
            <label for="speed">Velocidade de Rota√ß√£o:</label>
          <select id="speed">
            <option value="slow">Lenta</option>
            <option value="normal" selected>Normal</option>
            <option value="fast">R√°pida</option>
          </select>
          <div class="setting-description">
            Controla a velocidade do giro da roleta. Lenta = mais suspense, R√°pida = mais din√¢mica.
          </div>
        </div>
        </div>
        
        <div class="settings-card">
          <h3>üé® Apar√™ncia</h3>
          <div class="form-group">
            <label for="theme">Paleta de Cores:</label>
            <select id="theme">
              <option value="default" selected>Padr√£o</option>
              <option value="natal">Natal</option>
              <option value="mulheres">Dia das Mulheres</option>
              <option value="homens">Dia dos Homens</option>
              <option value="criancas">Dia das Crian√ßas</option>
              <option value="halloween">Halloween</option>
              <option value="pascoa">P√°scoa</option>
              <option value="carnaval">Carnaval</option>
              <option value="primavera">Primavera</option>
              <option value="verao">Ver√£o</option>
              <option value="inverno">Inverno</option>
              <option value="outono">Outono</option>
              <option value="neon">Neon</option>
              <option value="gold">Dourado</option>
              <option value="personalizada">Personalizada</option>
          </select>
          <div class="setting-description">
            Escolha uma paleta de cores tem√°tica para personalizar a apar√™ncia da roleta.
          </div>
          </div>
        </div>
        
        <div class="settings-card">
          <h3>üìä Porcentagens dos Pr√™mios</h3>
          <div class="switch-container">
            <span class="footer-text">Usar Porcentagens Personalizadas</span>
            <div class="switch" id="percentageSwitch" onclick="togglePercentages()"></div>
          </div>
          <div class="setting-description">
            Sistema padr√£o: todos os pr√™mios t√™m a mesma chance. Personalizado: voc√™ define a probabilidade de cada pr√™mio.
          </div>
          <div id="percentagesContainer" class="percentages-container" style="display:none;">
            <!-- As porcentagens ser√£o renderizadas aqui -->
          </div>
          <div class="percentage-total" id="percentageTotal" style="display:none;">
            <span>Total: <span id="totalPercentage">100</span>%</span>
          </div>
          <div id="percentageInfo" class="percentage-info">
            <p>Sistema padr√£o: Todos os pr√™mios t√™m a mesma chance de aparecer.</p>
          </div>
        </div>
        
        <div class="settings-card">
          <h3>üé≠ Comportamento</h3>
          <div class="switch-container">
            <span class="footer-text">Anima√ß√£o de Idle</span>
            <div class="switch" id="idleSwitch" onclick="toggleIdle()"></div>
          </div>
          <div class="setting-description">
            Quando ativada, a roleta faz uma anima√ß√£o sutil quando est√° parada, dando mais vida √† interface.
          </div>
          <div class="switch-container">
            <span class="footer-text">Popup de Pr√™mio</span>
            <div class="switch active" id="popupSwitch" onclick="togglePopup()"></div>
          </div>
          <div class="setting-description">
            Mostra um popup comemorativo quando algu√©m ganha um pr√™mio, tornando a experi√™ncia mais envolvente.
          </div>
        </div>
      </div>
      
      <div class="modal-buttons">
        <button class="btn-cancel" onclick="closeSettingsModal()">Cancelar</button>
        <button class="btn-save" onclick="saveSettings()">üíæ Salvar Configura√ß√µes</button>
      </div>
    </div>
  </div>

  <!-- Popup de Pr√™mio -->
  <div id="prizePopup" class="prize-popup" style="display:none;">
    <div class="prize-content">
      <h2>üéâ Parab√©ns!</h2>
      <p id="prizeText">Voc√™ ganhou: <strong id="prizeName"></strong></p>
      <button class="prize-close" onclick="closePrizePopup()">Continuar</button>
    </div>
  </div>

  <!-- Modal de Informa√ß√µes -->
  <div id="infoModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Informa√ß√µes</h2>
        <button class="close" onclick="closeInfoModal()">&times;</button>
      </div>
      
      <div style="text-align: center; padding: 20px;">
        <div style="background: rgba(246, 196, 83, 0.1); border: 2px solid #f6c453; border-radius: 15px; padding: 25px; margin: 20px 0;">
          <h3 style="color: #f6c453; font-size: 1.8rem; margin-bottom: 15px;">Desenvolvido por</h3>
          <div style="margin: 15px 0;">
            <img src="logo modelo colorido.png" alt="Neotech Solu√ß√µes" style="max-width: 200px; height: auto; filter: drop-shadow(0 4px 8px rgba(0,0,0,0.3));">
          </div>
          <p style="color: #666; font-size: 1rem;">Especialistas em desenvolvimento de solu√ß√µes tecnol√≥gicas inovadoras</p>
        </div>
        
        <div style="margin: 30px 0;">
          <h3 style="color: #f6c453; font-size: 1.3rem; margin-bottom: 15px;">Visite nosso site</h3>
          <div style="width: 200px; height: 200px; margin: 0 auto 20px; border-radius: 10px; overflow: hidden; box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);">
            <img src="frame.png" alt="QR Code para o site da Neotech Solu√ß√µes" style="width: 100%; height: 100%; object-fit: cover;">
          </div>
          <p style="color: #666; font-size: 0.9rem;">Escaneie o QR Code acima para acessar nosso site e conhecer mais sobre nossos servi√ßos</p>
        </div>
        
        <div style="text-align: left; margin-top: 30px;">
          <h3 style="color: #f6c453; font-size: 1.2rem; margin-bottom: 15px; text-align: center;">Recursos da Roleta</h3>
          <ul style="list-style: none; padding: 0; color: #333;">
            <li style="padding: 5px 0; position: relative; padding-left: 25px;">‚ú® Interface moderna e responsiva</li>
            <li style="padding: 5px 0; position: relative; padding-left: 25px;">‚ú® Personaliza√ß√£o completa de pr√™mios</li>
            <li style="padding: 5px 0; position: relative; padding-left: 25px;">‚ú® Sistema de porcentagens personalizadas</li>
            <li style="padding: 5px 0; position: relative; padding-left: 25px;">‚ú® M√∫ltiplos temas visuais</li>
            <li style="padding: 5px 0; position: relative; padding-left: 25px;">‚ú® Efeitos sonoros configur√°veis</li>
            <li style="padding: 5px 0; position: relative; padding-left: 25px;">‚ú® Anima√ß√µes suaves e envolventes</li>
            <li style="padding: 5px 0; position: relative; padding-left: 25px;">‚ú® Salvamento autom√°tico de configura√ß√µes</li>
            <li style="padding: 5px 0; position: relative; padding-left: 25px;">‚ú® Design otimizado para todos os dispositivos</li>
          </ul>
        </div>
      </div>
      
      <div class="modal-buttons">
        <button class="btn-save" onclick="closeInfoModal()">Fechar</button>
      </div>
    </div>
  </div>

  <!-- Rodap√© -->
  <div class="footer">
    <!-- Conte√∫do removido - apenas imagem de fundo -->
  </div>

<script>
/* =========================
   CONFIGURA√á√ÉO DOS PR√äMIOS
   ========================= */
let PRIZES = [
  "1 M√™s Gr√°tis",
  "Desconto 50%",
  "Brinde Especial",
  "Atualiza√ß√£o Premium",
  "Consultoria 1h",
  "Camiseta NeoTech",
  "Cupom R$100",
  "Sticker Pack",
  "Caf√© com o Dev",
  "Acesso Beta",
  "Suporte VIP",
  "Nada"
];

// Porcentagens de chance para cada pr√™mio (deve somar 100%)
let PRIZE_PERCENTAGES = [
  5,   // 1 M√™s Gr√°tis - 5%
  10,  // Desconto 50% - 10%
  15,  // Brinde Especial - 15%
  8,   // Atualiza√ß√£o Premium - 8%
  12,  // Consultoria 1h - 12%
  5,   // Camiseta NeoTech - 5%
  10,  // Cupom R$100 - 10%
  8,   // Sticker Pack - 8%
  7,   // Caf√© com o Dev - 7%
  5,   // Acesso Beta - 5%
  8,   // Suporte VIP - 8%
  7    // Nada - 7%
];

// Array para marcar quais pr√™mios s√£o "perdas" (true = perda, false = pr√™mio)
let PRIZE_IS_LOSS = [
  false, // 1 M√™s Gr√°tis - pr√™mio
  false, // Desconto 50% - pr√™mio
  false, // Brinde Especial - pr√™mio
  false, // Atualiza√ß√£o Premium - pr√™mio
  false, // Consultoria 1h - pr√™mio
  false, // Camiseta NeoTech - pr√™mio
  false, // Cupom R$100 - pr√™mio
  false, // Sticker Pack - pr√™mio
  false, // Caf√© com o Dev - pr√™mio
  false, // Acesso Beta - pr√™mio
  false, // Suporte VIP - pr√™mio
  true   // Nada - perda
];

// Fun√ß√£o para selecionar pr√™mio baseado nas porcentagens
function selectPrizeByPercentage() {
  const total = PRIZE_PERCENTAGES.reduce((sum, percent) => sum + percent, 0);
  const random = Math.random() * total;
  
  let currentSum = 0;
  for (let i = 0; i < PRIZE_PERCENTAGES.length; i++) {
    currentSum += PRIZE_PERCENTAGES[i];
    if (random <= currentSum) {
      return i;
    }
  }
  return PRIZES.length - 1; // fallback para o √∫ltimo pr√™mio
}

// Fun√ß√£o para normalizar porcentagens (garantir que somem 100%)
function normalizePercentages() {
  const total = PRIZE_PERCENTAGES.reduce((sum, percent) => sum + percent, 0);
  if (total !== 100) {
    const factor = 100 / total;
    PRIZE_PERCENTAGES = PRIZE_PERCENTAGES.map(percent => Math.round(percent * factor));
  }
}

// Configura√ß√µes
let settings = {
  soundEnabled: true,
  speed: 'normal',
  theme: 'default',
  idleAnimation: true,
  showPopup: true,
  usePercentages: false  // Nova configura√ß√£o para usar porcentagens
};

/* ====== N√∫cleo da Roleta (Canvas + F√≠sica + √Åudio) ====== */
const canvas = document.getElementById('wheel');
const ctx = canvas.getContext('2d');
const spinBtn = document.getElementById('spinBtn');
const shuffleBtn = document.getElementById('shuffleBtn');
const nudgeBtn = document.getElementById('nudgeBtn');
const resultEl = document.getElementById('result');

const W = canvas.width, H = canvas.height, CX = W/2, CY = H/2;
let R = Math.min(W, H)/2 - 24;
let INNER_R = R * 0.32;
let SEG_ANGLE = (Math.PI * 2) / PRIZES.length;

// Fun√ß√£o para recalcular dimens√µes baseadas no n√∫mero de pr√™mios
function updateWheelDimensions() {
  R = Math.min(W, H)/2 - 24;
  INNER_R = R * 0.32;
  SEG_ANGLE = (Math.PI * 2) / PRIZES.length;
}

// Paletas de cores tem√°ticas
const colorPalettes = {
  default: ["#eec116","#2e3d88","#4a9eff","#eec116","#2e3d88","#4a9eff","#eec116","#2e3d88","#4a9eff","#eec116","#2e3d88","#4a9eff","#eec116","#2e3d88"],
  natal: ["#dc2626","#059669","#dc2626","#059669","#dc2626","#059669","#dc2626","#059669","#dc2626","#059669","#dc2626","#059669","#dc2626","#059669"],
  mulheres: ["#ec4899","#f472b6","#f9a8d4","#fce7f3","#ec4899","#f472b6","#f9a8d4","#fce7f3","#ec4899","#f472b6","#f9a8d4","#fce7f3","#ec4899","#f472b6"],
  homens: ["#3b82f6","#1d4ed8","#2563eb","#1e40af","#3b82f6","#1d4ed8","#2563eb","#1e40af","#3b82f6","#1d4ed8","#2563eb","#1e40af","#3b82f6","#1d4ed8"],
  criancas: ["#f59e0b","#f97316","#ef4444","#ec4899","#8b5cf6","#06b6d4","#10b981","#84cc16","#f59e0b","#f97316","#ef4444","#ec4899","#8b5cf6","#06b6d4"],
  neon: ["#00ffff","#ff00ff","#ffff00","#00ff00","#ff0080","#8000ff","#0080ff","#ff8000","#00ffff","#ff00ff","#ffff00","#00ff00","#ff0080","#8000ff"],
  gold: ["#ffd700","#ffed4e","#fbbf24","#f59e0b","#d97706","#b45309","#92400e","#78350f","#ffd700","#ffed4e","#fbbf24","#f59e0b","#d97706","#b45309"],
  halloween: ["#7c2d12","#ea580c","#f97316","#fb923c","#fed7aa","#7c2d12","#ea580c","#f97316","#fb923c","#fed7aa","#7c2d12","#ea580c","#f97316","#fb923c"],
  pascoa: ["#fbbf24","#f59e0b","#84cc16","#22c55e","#10b981","#06b6d4","#3b82f6","#6366f1","#8b5cf6","#ec4899","#fbbf24","#f59e0b","#84cc16","#22c55e"],
  carnaval: ["#f59e0b","#ef4444","#ec4899","#8b5cf6","#3b82f6","#06b6d4","#10b981","#84cc16","#f59e0b","#ef4444","#ec4899","#8b5cf6","#3b82f6","#06b6d4"],
  primavera: ["#fbbf24","#84cc16","#22c55e","#10b981","#06b6d4","#3b82f6","#6366f1","#8b5cf6","#ec4899","#f472b6","#fbbf24","#84cc16","#22c55e","#10b981"],
  verao: ["#fbbf24","#f59e0b","#ef4444","#ec4899","#8b5cf6","#3b82f6","#06b6d4","#10b981","#84cc16","#fbbf24","#f59e0b","#ef4444","#ec4899","#8b5cf6"],
  inverno: ["#3b82f6","#1d4ed8","#6366f1","#8b5cf6","#a855f7","#c084fc","#d8b4fe","#e9d5ff","#3b82f6","#1d4ed8","#6366f1","#8b5cf6","#a855f7","#c084fc"],
  outono: ["#92400e","#b45309","#d97706","#f59e0b","#fbbf24","#84cc16","#22c55e","#10b981","#92400e","#b45309","#d97706","#f59e0b","#fbbf24","#84cc16"],
  personalizada: ["#eec116","#2e3d88","#4a9eff","#eec116","#2e3d88","#4a9eff","#eec116","#2e3d88","#4a9eff","#eec116","#2e3d88","#4a9eff","#eec116","#2e3d88"]
};

// Paleta base para setores
function sectorColor(i){
  const palette = colorPalettes[settings.theme] || colorPalettes.default;
  return palette[i % palette.length];
}

// Texto horizontal por setor - sempre deitado com suporte a emojis
function drawCurvedText(text, startAngle, sweep){
  ctx.save();
  ctx.fillStyle = "#fff";
  
  // Ajusta o tamanho da fonte baseado no n√∫mero de pr√™mios
  const fontSizeMultiplier = PRIZES.length <= 6 ? 0.08 : PRIZES.length <= 10 ? 0.055 : PRIZES.length <= 14 ? 0.04 : 0.03;
  ctx.font = `bold ${Math.floor(R*fontSizeMultiplier)}px system-ui,Segoe UI,Inter,Arial`;
  ctx.textAlign = "center";
  ctx.textBaseline = "middle";

  const radius = (INNER_R + R) / 2;
  
  // Sempre usar texto horizontal no centro do setor
  const centerAngle = startAngle + sweep/2;
  const centerX = CX + radius*Math.cos(centerAngle);
  const centerY = CY + radius*Math.sin(centerAngle);
  
  ctx.save();
  ctx.translate(centerX, centerY);
  // Rotacionar para ficar horizontal/deitado
  ctx.rotate(centerAngle);
  
  // Quebrar texto em linhas se necess√°rio (considerando emojis)
  const words = text.split(' ');
  let lines = [];
  
  if(words.length > 1 && text.length > 8) {
    // Tentar quebrar em 2 linhas
    const midPoint = Math.ceil(words.length / 2);
    lines.push(words.slice(0, midPoint).join(' '));
    lines.push(words.slice(midPoint).join(' '));
  } else if(text.length > 12) {
    // Se for uma palavra longa, quebrar no meio (considerando emojis)
    const midPoint = Math.ceil(text.length / 2);
    lines.push(text.substring(0, midPoint));
    lines.push(text.substring(midPoint));
  } else {
    lines = [text];
  }
  
  // Desenhar cada linha
  const lineHeight = Math.floor(R*fontSizeMultiplier) * 1.3;
  for(let i = 0; i < lines.length; i++) {
    const y = (i - (lines.length - 1) / 2) * lineHeight;
    
    // Contorno preto para melhor visibilidade
    ctx.strokeStyle = "#000";
    ctx.lineWidth = Math.max(2, Math.floor(R*0.003));
    ctx.strokeText(lines[i], 0, y);
    ctx.fillText(lines[i], 0, y);
  }
  
  ctx.restore();
  ctx.restore();
}

// Desenha a roleta para um √¢ngulo (rota√ß√£o) dado
function drawWheel(rotation=0){
  ctx.clearRect(0,0,W,H);

  // sombra suave
  ctx.save();
  ctx.beginPath();
  ctx.arc(CX, CY, R+10, 0, Math.PI*2);
  ctx.shadowColor = "rgba(0,0,0,.35)";
  ctx.shadowBlur = 28;
  ctx.fillStyle = "#0b0f26";
  ctx.fill();
  ctx.restore();

  // setores
  for(let i=0;i<PRIZES.length;i++){
    const start = i*SEG_ANGLE + rotation;
    const end = start + SEG_ANGLE;

    // fatia
    ctx.beginPath();
    ctx.moveTo(CX, CY);
    ctx.arc(CX, CY, R, start, end);
    ctx.closePath();
    
    // preenchimento com cor s√≥lida
    ctx.fillStyle = sectorColor(i);
    ctx.fill();

    // divis√≥ria
    ctx.strokeStyle = "#00000055";
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.arc(CX, CY, R, start, end);
    ctx.stroke();

    // texto curvado
    drawCurvedText(PRIZES[i], start, SEG_ANGLE);
  }

  // "miolo" - c√≠rculo central com cor s√≥lida
  ctx.beginPath();
  ctx.arc(CX, CY, INNER_R, 0, Math.PI*2);
  ctx.fillStyle = "#f6c453"; // Cor dourada s√≥lida
  ctx.fill();
  
  // Borda do c√≠rculo central
  ctx.strokeStyle = "#000";
  ctx.lineWidth = 3;
  ctx.stroke();

  // aro dourado
  ctx.lineWidth = 20;
  ctx.strokeStyle = "#f6c453";
  ctx.beginPath();
  ctx.arc(CX, CY, R, 0, Math.PI*2);
  ctx.stroke();

}

// ====== √Åudio (ticks + fanfarra) ======
let audioCtx;
function ensureAudio(){
  if(!audioCtx){
    audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  }
}
function beepTick(){
  if(!audioCtx || !settings.soundEnabled) return;
  const osc = audioCtx.createOscillator();
  const gain = audioCtx.createGain();
  osc.type = "square";
  osc.frequency.value = 1100;
  gain.gain.value = 0.0001;
  osc.connect(gain).connect(audioCtx.destination);
  osc.start();
  gain.gain.exponentialRampToValueAtTime(0.1, audioCtx.currentTime + 0.005);
  gain.gain.exponentialRampToValueAtTime(0.00001, audioCtx.currentTime + 0.04);
  osc.stop(audioCtx.currentTime + 0.05);
}
function fanfare(){
  if(!audioCtx || !settings.soundEnabled) return;
  const notes = [523,659,784,1046];
  let t = audioCtx.currentTime;
  notes.forEach((f, i)=>{
    const o = audioCtx.createOscillator();
    const g = audioCtx.createGain();
    o.type="sine"; o.frequency.value=f;
    g.gain.value=0.0001;
    o.connect(g).connect(audioCtx.destination);
    o.start(t + i*0.08);
    g.gain.exponentialRampToValueAtTime(0.15, t + i*0.08 + 0.02);
    g.gain.exponentialRampToValueAtTime(0.00001, t + i*0.08 + 0.25);
    o.stop(t + i*0.08 + 0.26);
  });
}

// ====== Anima√ß√£o do giro ======
let animId = null;
let spinning = false;
let currentRot = 0;
let lastTickIndex = -1;

function easeOutQuint(x){ return 1 - Math.pow(1 - x, 5); }

function spin(targetIndex=null){
  if(spinning) {
    return;
  }
  ensureAudio();
  spinning = true;
  spinBtn.disabled = true; shuffleBtn.disabled = true;
  spinBtn.classList.add('spinning');
  resultEl.textContent = "Girando...";

  const idx = (targetIndex==null)
    ? (settings.usePercentages ? selectPrizeByPercentage() : Math.floor(Math.random()*PRIZES.length))
    : ((targetIndex%PRIZES.length)+PRIZES.length)%PRIZES.length;

  const pointerAngle = -Math.PI/2;
  const centerOfSector = idx*SEG_ANGLE + SEG_ANGLE/2;
  const base = pointerAngle - centerOfSector;

  // Velocidade baseada nas configura√ß√µes
  let extraTurns, duration;
  switch(settings.speed) {
    case 'slow':
      extraTurns = 5 + Math.floor(Math.random()*2);
      duration = 4000 + Math.random()*1000;
      break;
    case 'fast':
      extraTurns = 3 + Math.floor(Math.random()*2);
      duration = 2400 + Math.random()*600;
      break;
    default:
      extraTurns = 4 + Math.floor(Math.random()*3);
      duration = 3200 + Math.random()*800;
  }

  const finalRotation = base + extraTurns * Math.PI * 2;
  const start = performance.now();
  lastTickIndex = -1;

  function frame(now){
    const t = Math.min(1, (now - start)/duration);
    const e = easeOutQuint(t);
    const angle = currentRot + (finalRotation)*e;
    drawWheel(angle);

    const normalized = (angle % (Math.PI*2) + Math.PI*2) % (Math.PI*2);
    // Calcular qual setor est√° sendo apontado pelo ponteiro no topo
    const pointerAngle = -Math.PI/2;
    const normalizedPointer = (pointerAngle - normalized + Math.PI*2) % (Math.PI*2);
    const crossedIndex = Math.floor(normalizedPointer / SEG_ANGLE) % PRIZES.length;
    if (crossedIndex !== lastTickIndex){
      beepTick();
      lastTickIndex = crossedIndex;
    }

    if(t < 1){
      animId = requestAnimationFrame(frame);
    } else {
      currentRot = angle % (Math.PI*2);
      spinning = false;
      spinBtn.disabled = false; shuffleBtn.disabled = false;
      spinBtn.classList.remove('spinning');
      fanfare();
      const norm = (currentRot % (Math.PI*2) + Math.PI*2) % (Math.PI*2);
      // O ponteiro est√° no topo (meio-dia), ent√£o precisamos calcular qual setor est√° sendo apontado
      // O ponteiro aponta para -Math.PI/2 (topo), ent√£o o setor vencedor √© o que est√° nessa posi√ß√£o
      const pointerAngle = -Math.PI/2;
      const normalizedPointer = (pointerAngle - norm + Math.PI*2) % (Math.PI*2);
      const winIndex = Math.floor(normalizedPointer / SEG_ANGLE) % PRIZES.length;
      const prize = PRIZES[winIndex];
      const isLoss = PRIZE_IS_LOSS[winIndex];
      
      // Mensagem diferente baseada no tipo de pr√™mio
      if(isLoss) {
        resultEl.textContent = `üòî Que pena! Voc√™ tirou: ${prize}`;
        if(settings.showPopup) {
          showPrizePopup(prize, true); // true indica que √© uma perda
        }
      } else {
        resultEl.textContent = `üéâ Voc√™ ganhou: ${prize}`;
        if(settings.showPopup) {
          showPrizePopup(prize, false); // false indica que √© um pr√™mio
        }
      }
    }
  }
  animId = requestAnimationFrame(frame);
}

// ====== Utilidades ======
function shuffle(array){
  for(let i=array.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [array[i], array[j]] = [array[j], array[i]];
  }
}
function pickTestIndex(){
  return Math.floor(Math.random()*PRIZES.length);
}

// ====== Modais ======
function openEditModal(){
  // Carregar o t√≠tulo atual
  document.getElementById('editEventTitle').value = document.getElementById('eventTitle').value;
  renderPrizes();
  document.getElementById('editModal').style.display = 'block';
}

function closeEditModal(){
  document.getElementById('editModal').style.display = 'none';
}

function openSettingsModal(){
  // Inicializar switches com estado atual
  document.getElementById('soundSwitch').classList.toggle('active', settings.soundEnabled);
  document.getElementById('idleSwitch').classList.toggle('active', settings.idleAnimation);
  document.getElementById('popupSwitch').classList.toggle('active', settings.showPopup);
  document.getElementById('percentageSwitch').classList.toggle('active', settings.usePercentages);
  
  // Configurar visibilidade das porcentagens
  const container = document.getElementById('percentagesContainer');
  const total = document.getElementById('percentageTotal');
  const info = document.getElementById('percentageInfo');
  
  if (settings.usePercentages) {
    container.style.display = 'block';
    total.style.display = 'block';
    info.style.display = 'none';
    renderPercentages();
  } else {
    container.style.display = 'none';
    total.style.display = 'none';
    info.style.display = 'block';
  }
  
  document.getElementById('settingsModal').style.display = 'block';
}

function closeSettingsModal(){
  document.getElementById('settingsModal').style.display = 'none';
}

function openInfoModal(){
  document.getElementById('infoModal').style.display = 'block';
}

function closeInfoModal(){
  document.getElementById('infoModal').style.display = 'none';
}

function renderPrizes(){
  const container = document.getElementById('prizesContainer');
  container.innerHTML = '';
  PRIZES.forEach((prize, index) => {
    const div = document.createElement('div');
    div.className = 'prize-input';
    div.innerHTML = `
      <span class="prize-number">${index + 1}</span>
      <input type="text" value="${prize}" placeholder="Ex: Cupom R$ 50, Brinde especial, etc.">
      <label class="loss-checkbox">
        <input type="checkbox" ${PRIZE_IS_LOSS[index] ? 'checked' : ''} onchange="toggleLoss(${index})">
        <span>üòî Perda</span>
      </label>
      <button class="remove-prize" onclick="removePrize(${index})" title="Remover este pr√™mio">√ó</button>
    `;
    container.appendChild(div);
  });
}

// Fun√ß√£o para renderizar as porcentagens no modal de configura√ß√µes
function renderPercentages(){
  const container = document.getElementById('percentagesContainer');
  container.innerHTML = '';
  
  PRIZES.forEach((prize, index) => {
    const div = document.createElement('div');
    div.className = 'percentage-item';
    div.innerHTML = `
      <span class="percentage-label">${prize}</span>
      <input type="number" class="percentage-input" value="${PRIZE_PERCENTAGES[index]}" 
             min="0" max="100" onchange="updatePercentage(${index}, this.value)">
      <span style="color:#f6c453;">%</span>
    `;
    container.appendChild(div);
  });
  
  updateTotalPercentage();
}

// Fun√ß√£o para atualizar uma porcentagem espec√≠fica
function updatePercentage(index, value) {
  PRIZE_PERCENTAGES[index] = parseInt(value) || 0;
  updateTotalPercentage();
}

// Fun√ß√£o para alternar entre porcentagens personalizadas e sistema padr√£o
function togglePercentages() {
  settings.usePercentages = !settings.usePercentages;
  const switchElement = document.getElementById('percentageSwitch');
  const container = document.getElementById('percentagesContainer');
  const total = document.getElementById('percentageTotal');
  const info = document.getElementById('percentageInfo');
  
  switchElement.classList.toggle('active', settings.usePercentages);
  
  if (settings.usePercentages) {
    container.style.display = 'block';
    total.style.display = 'block';
    info.style.display = 'none';
    renderPercentages();
  } else {
    container.style.display = 'none';
    total.style.display = 'none';
    info.style.display = 'block';
  }
}

function addPrize(){
  PRIZES.push('');
  PRIZE_PERCENTAGES.push(8); // Porcentagem padr√£o para novos pr√™mios
  PRIZE_IS_LOSS.push(false); // Novo pr√™mio n√£o √© perda por padr√£o
  renderPrizes();
}

function toggleLoss(index){
  PRIZE_IS_LOSS[index] = !PRIZE_IS_LOSS[index];
}

function removePrize(index){
  if(PRIZES.length > 2) {
    PRIZES.splice(index, 1);
    PRIZE_PERCENTAGES.splice(index, 1);
    PRIZE_IS_LOSS.splice(index, 1);
    updateWheelDimensions(); // Recalcular dimens√µes
    renderPrizes();
    drawWheel(currentRot); // Redesenhar a roleta
  }
}

function savePrizes(){
  // Salvar o t√≠tulo editado
  const newTitle = document.getElementById('editEventTitle').value.trim();
  if(newTitle) {
    document.getElementById('eventTitle').value = newTitle;
  }
  
  // Salvar os pr√™mios e suas configura√ß√µes de perda
  const prizeInputs = document.querySelectorAll('#prizesContainer input[type="text"]');
  const lossCheckboxes = document.querySelectorAll('#prizesContainer input[type="checkbox"]');
  
  // Filtrar pr√™mios vazios e manter correspond√™ncia com checkboxes
  const validPrizes = [];
  const validLosses = [];
  
  prizeInputs.forEach((input, index) => {
    const prize = input.value.trim();
    if(prize) { // S√≥ adiciona se n√£o estiver vazio
      validPrizes.push(prize);
      validLosses.push(lossCheckboxes[index] ? lossCheckboxes[index].checked : false);
    }
  });
  
  PRIZES = validPrizes;
  PRIZE_IS_LOSS = validLosses;
  
  if(PRIZES.length < 2) {
    alert('√â necess√°rio pelo menos 2 pr√™mios!');
    return;
  }
  
  // Ajustar arrays de porcentagens se necess√°rio
  while(PRIZE_PERCENTAGES.length < PRIZES.length) {
    PRIZE_PERCENTAGES.push(8);
  }
  while(PRIZE_PERCENTAGES.length > PRIZES.length) {
    PRIZE_PERCENTAGES.pop();
  }
  
  updateWheelDimensions(); // Recalcular dimens√µes
  
  // Salvar pr√™mios no localStorage
  localStorage.setItem('roletaPrizes', JSON.stringify(PRIZES));
  localStorage.setItem('roletaPrizeLosses', JSON.stringify(PRIZE_IS_LOSS));
  
  closeEditModal();
  drawWheel(currentRot);
}

// Fun√ß√µes do popup de pr√™mio
function showPrizePopup(prize, isLoss = false){
  const prizeNameElement = document.getElementById('prizeName');
  const popupElement = document.getElementById('prizePopup');
  const prizeTitleElement = document.querySelector('.prize-content h2');
  
  // Debug: verificar se o pr√™mio est√° vazio ou undefined
  if(!prize || prize.trim() === '') {
    console.warn('Pr√™mio vazio ou indefinido:', prize);
    return;
  }
  
  if(prizeNameElement && popupElement && prizeTitleElement) {
    prizeNameElement.textContent = prize;
    
    // Mudar t√≠tulo e estilo baseado no tipo
    if(isLoss) {
      prizeTitleElement.textContent = 'üòî Que pena!';
      prizeTitleElement.style.color = '#ff6b6b'; // Cor vermelha para perdas
    } else {
      prizeTitleElement.textContent = 'üéâ Parab√©ns!';
      prizeTitleElement.style.color = '#f6c453'; // Cor dourada para pr√™mios
    }
    
    popupElement.style.display = 'flex';
  } else {
    console.error('Elementos do popup n√£o encontrados:', {
      prizeNameElement: !!prizeNameElement,
      popupElement: !!popupElement,
      prizeTitleElement: !!prizeTitleElement
    });
  }
}

function closePrizePopup(){
  document.getElementById('prizePopup').style.display = 'none';
}

// Fun√ß√£o para carregar configura√ß√µes do localStorage
function loadSettings(){
  // Carregar configura√ß√µes gerais
  const savedSettings = localStorage.getItem('roletaSettings');
  if(savedSettings) {
    try {
      const parsedSettings = JSON.parse(savedSettings);
      // Mesclar configura√ß√µes salvas com as padr√£o
      settings = {...settings, ...parsedSettings};
    } catch(e) {
      console.warn('Erro ao carregar configura√ß√µes:', e);
    }
  }
  
  // Carregar pr√™mios salvos
  const savedPrizes = localStorage.getItem('roletaPrizes');
  if(savedPrizes) {
    try {
      PRIZES = JSON.parse(savedPrizes);
    } catch(e) {
      console.warn('Erro ao carregar pr√™mios:', e);
    }
  }
  
  // Carregar configura√ß√µes de perda dos pr√™mios
  const savedPrizeLosses = localStorage.getItem('roletaPrizeLosses');
  if(savedPrizeLosses) {
    try {
      PRIZE_IS_LOSS = JSON.parse(savedPrizeLosses);
    } catch(e) {
      console.warn('Erro ao carregar configura√ß√µes de perda:', e);
    }
  }
  
  // Recalcular dimens√µes se os pr√™mios mudaram
  if(savedPrizes) {
    updateWheelDimensions();
  }
}

function saveSettings(){
  settings.soundEnabled = document.getElementById('soundSwitch').classList.contains('active');
  settings.speed = document.getElementById('speed').value;
  settings.theme = document.getElementById('theme').value;
  settings.idleAnimation = document.getElementById('idleSwitch').classList.contains('active');
  settings.showPopup = document.getElementById('popupSwitch').classList.contains('active');
  settings.usePercentages = document.getElementById('percentageSwitch').classList.contains('active');
  
  // Salvar no localStorage
  localStorage.setItem('roletaSettings', JSON.stringify(settings));
  
  closeSettingsModal();
  drawWheel(currentRot); // Redesenha com nova paleta de cores
}

// Fun√ß√µes dos switches
function toggleSound(){
  const switchEl = document.getElementById('soundSwitch');
  switchEl.classList.toggle('active');
}

function toggleIdle(){
  const switchEl = document.getElementById('idleSwitch');
  switchEl.classList.toggle('active');
}

function togglePopup(){
  const switchEl = document.getElementById('popupSwitch');
  switchEl.classList.toggle('active');
}

// Fun√ß√£o para upload de QR Code
function uploadQR(){
  const input = document.createElement('input');
  input.type = 'file';
  input.accept = 'image/*';
  input.onchange = function(e){
    const file = e.target.files[0];
    if(file){
      const reader = new FileReader();
      reader.onload = function(e){
        const qrPlaceholder = document.querySelector('.qr-placeholder');
        qrPlaceholder.innerHTML = `<img src="${e.target.result}" style="width:100%; height:100%; border-radius:6px;" alt="QR Code">`;
      };
      reader.readAsDataURL(file);
    }
  };
  input.click();
}

// Fun√ß√£o para debug do ponteiro
function debugPointer(){
  const norm = (currentRot % (Math.PI*2) + Math.PI*2) % (Math.PI*2);
  const pointerAngle = -Math.PI/2;
  const normalizedPointer = (pointerAngle - norm + Math.PI*2) % (Math.PI*2);
  const winIndex = Math.floor(normalizedPointer / SEG_ANGLE) % PRIZES.length;
}

// ====== Eventos ======
document.getElementById('infoBtn').addEventListener('click', openInfoModal);
document.getElementById('customizeBtn').addEventListener('click', openEditModal);
document.getElementById('settingsBtn').addEventListener('click', openSettingsModal);
spinBtn.addEventListener('click', ()=> {
  spin();
});
shuffleBtn.addEventListener('click', ()=>{
  shuffle(PRIZES);
  resultEl.textContent = "Pr√™mios embaralhados.";
  drawWheel(currentRot);
});

// ====== Inicializa√ß√£o ======
let idleStart = null;
function idleRotate(ts){
  if(!idleStart) idleStart = ts;
  const t = (ts - idleStart)/1000;
  if(!spinning && settings.idleAnimation){
    const idle = currentRot + (Math.sin(t*0.6)*0.002);
    drawWheel(idle);
  } else if(!spinning) {
    drawWheel(currentRot);
  }
  requestAnimationFrame(idleRotate);
}
// Carregar configura√ß√µes salvas
loadSettings();

drawWheel(0);
requestAnimationFrame(idleRotate);

// Acessibilidade de teclado
window.addEventListener('keydown', (e)=>{
  if(e.code === 'Space'){ e.preventDefault(); spin(); }
});

// Fechar modais clicando fora
window.addEventListener('click', (e)=>{
  if(e.target.classList.contains('modal')){
    e.target.style.display = 'none';
  }
  if(e.target.classList.contains('prize-popup')){
    closePrizePopup();
  }
});

// Fechar popup com ESC
window.addEventListener('keydown', (e)=>{
  if(e.key === 'Escape'){
    closePrizePopup();
    closeEditModal();
    closeSettingsModal();
    closeInfoModal();
  }
});

</script>
</body>
</html>